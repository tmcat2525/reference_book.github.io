---
layout: post
title:  "Welcome to Jekyll!"
date:   2025-04-26 00:03:16 +0900
categories: jekyll update
---
# AWS認定 ソリューションアーキテクト アソシエイト 合格対策参考書（SAA-C03対応） - Part 2


### 第3章: データベースサービス (RDS, DynamoDB, Redshift, ElastiCache, Aurora)

#### 3.1 分野概要

データベースはアプリケーションのデータを永続的に保存し、効率的にアクセスするための基盤です。AWSは様々なタイプのデータベースサービスを提供しており、ワークロードの特性（リレーショナル vs 非リレーショナル、読み取り/書き込みパターン、スケーラビリティ要件、運用負荷など）に応じて最適なものを選択する必要があります。この章では、リレーショナルデータベースの**Amazon RDS**と**Amazon Aurora**、NoSQLデータベースの**Amazon DynamoDB**、データウェアハウスの**Amazon Redshift**、インメモリキャッシュの**Amazon ElastiCache**を中心に学びます。

#### 3.2 主要AWSサービス解説

* **Amazon RDS (Relational Database Service):**
    * クラウド上でリレーショナルデータベース（MySQL, PostgreSQL, MariaDB, Oracle, SQL Server）を簡単にセットアップ、運用、スケールできる**マネージド型**サービス。
    * OSのパッチ適用、バックアップ、ソフトウェアアップデートなどの運用タスクをAWSが管理。
    * **マルチAZ配置**により可用性を向上（障害時にスタンバイインスタンスへ自動フェイルオーバー）。
    * **リードレプリカ**を作成して読み取り負荷を分散し、パフォーマンスを向上（非同期レプリケーション）。
    * **自動バックアップ**と**手動スナップショット**機能を提供。
    * **重要キーワード:** マネージド型サービス, リレーショナルデータベース(RDB), マルチAZ配置, フェイルオーバー, リードレプリカ, 自動バックアップ, スナップショット, DBインスタンスクラス, ストレージタイプ

* **Amazon Aurora:**
    * MySQLおよびPostgreSQLと互換性のある、AWSがクラウド向けに再設計した高性能リレーショナルデータベース。RDSの一種。
    * 標準的なMySQLより最大5倍、PostgreSQLより最大3倍高速。
    * ストレージが**自動的にスケーリング**（最大128TB）。
    * データは3つのAZに6つのコピーが作成され、高い**耐久性**と**可用性**を実現（クラスター構成）。
    * 最大15個の**Auroraレプリカ**（低レイテンシなリードレプリカ）を作成可能。
    * **Aurora Serverless:** 負荷に応じて自動的に起動/停止、スケールするオプション。予測不能なワークロードや開発/テスト環境に最適。
    * **Aurora Global Database:** 複数のAWSリージョンに低レイテンシで読み取り/書き込み可能なデータベースを展開。DR対策にも有効。
    * **重要キーワード:** MySQL/PostgreSQL互換, 高性能, ストレージ自動スケーリング, Auroraレプリカ, Aurora Serverless, Aurora Global Database, クラスターエンドポイント, リーダーエンドポイント

* **Amazon DynamoDB:**
    * フルマネージド型の**NoSQLキーバリューストア**および**ドキュメントデータベース**。
    * ミリ秒単位のレイテンシーで、あらゆる規模に対応できる高い**スケーラビリティ**を持つ。
    * サーバー管理不要（**サーバーレス**）。
    * **キャパシティモード**を選択:
        * **プロビジョンド:** 事前に読み取り/書き込みキャパシティユニット(RCU/WCU)を設定。予測可能なワークロード向け。Auto Scalingと組み合わせ可能。リザーブドキャパシティでコスト削減も。
        * **オンデマンド:** リクエスト量に応じて自動でスケール。予測不能なワークロード向け。
    * **DynamoDB Accelerator (DAX):** インメモリキャッシュを追加し、読み取りパフォーマンスをマイクロ秒単位に高速化。
    * **グローバルテーブル:** マルチリージョン・マルチアクティブ構成を実現。
    * **DynamoDB Streams:** テーブルへの変更イベント（項目の追加、更新、削除）をキャプチャし、Lambdaなどに連携可能。
    * **TTL (Time To Live):** 有効期限が切れた項目を自動的に削除。
    * **重要キーワード:** NoSQL, キーバリューストア, ドキュメントデータベース, サーバーレス, 高スケーラビリティ, 低レイテンシー, キャパシティモード(プロビジョンド/オンデマンド), RCU/WCU, DAX, グローバルテーブル, DynamoDB Streams, TTL

* **Amazon Redshift:**
    * 高速でスケーラブルな**データウェアハウス(DWH)**サービス。
    * ペタバイト規模のデータを扱え、標準SQLを用いた複雑な分析クエリを実行可能。
    * **カラムナストレージ**（列指向ストレージ）を採用し、分析クエリのパフォーマンスを最適化。
    * **クラスター**（ノードの集合）として構成。ノードタイプや数を選択。
    * **Redshift Spectrum:** S3上のデータレイクに対して直接SQLクエリを実行できる機能。
    * **WLM (Workload Management):** クエリの優先順位付けやリソース割り当てを管理。
    * **スナップショット**によるバックアップ。
    * **重要キーワード:** データウェアハウス(DWH), カラムナストレージ, クラスター, ノード, Redshift Spectrum, WLM, SQL分析

* **Amazon ElastiCache:**
    * フルマネージド型の**インメモリキャッシュ**サービス。RedisまたはMemcachedエンジンを選択可能。
    * データベース（RDSなど）やAPIへの負荷を軽減し、アプリケーションの応答速度を向上させる。
    * **Redis:** 高機能。永続化、レプリケーション、高可用性（マルチAZ）などをサポート。データ構造も豊富。
    * **Memcached:** シンプルで高速。複数ノードへの分散が得意。永続化はサポートしない。
    * **重要キーワード:** インメモリキャッシュ, Redis, Memcached, レイテンシー削減, DB負荷軽減

#### 3.3 問題演習とポイント解説

**(問題1より)**
* **[ポイント]** **Redshift**のコストは主に**ノードの稼働時間**と**データ量（スナップショット含む）**で決まります。コスト削減策としては、**不要なスナップショットの削除**（特に手動スナップショットや古い自動スナップショット）、ノードタイプの見直し、**リザーブドノード**の利用、クラスターの一時停止などが考えられます。Redshiftではスポットノードは利用できません。拡張VPCルーティングやCloudWatch基本メトリクスは直接的なコスト増にはなりにくいです。
* **出題傾向:** Redshiftのコスト要因と削減方法。スナップショット管理の重要性。
* **重要キーワード:** Redshift, コスト削減, スナップショット, リザーブドノード

**(問題4より)** [cite: 2]
* **[ポイント]** オンプレミスのストレージをAWSに拡張し、頻繁にアクセスされるデータをローカルにキャッシュしつつS3をプライマリストレージとして使用したい場合、**Storage Gatewayのキャッシュ型ボリューム**が最適です。
* **出題傾向:** Storage Gatewayのタイプ選択（再掲）。ハイブリッドクラウドストレージの構成。
* **重要キーワード:** Storage Gateway, キャッシュ型ボリューム

**(問題8より)** [cite: 5]
* **[ポイント]** 大量のクリックストリームデータのような**ストリーミングデータ**を収集・処理・分析するには、**Amazon Kinesis**ファミリーを利用するのが一般的です。
    * データ収集: **Kinesis Data Streams** (リアルタイム処理) または Kinesis Data Firehose (ニアリアルタイム配信)
    * データ配信/変換/ロード: **Kinesis Data Firehose** (S3, Redshift, OpenSearchなどへ)
    * データ分析: **Kinesis Data Analytics** (現在は **Amazon Managed Service for Apache Flink**), またはFirehoseでロードした先のサービス (例: Redshift, Athena)
    この問題では、ストリームデータを収集(Kinesis Data Streams) -> S3データレイクへ配信(Kinesis Data Firehose) -> S3上のデータを分析(Redshift Spectrum)という流れが最適解とされています。
* **出題傾向:** ストリーミングデータ処理のアーキテクチャパターン。Kinesisファミリーの各サービスの役割と連携。
* **よく出るサービスの組み合わせ:** Kinesis Data Streams + Kinesis Data Firehose + S3 + Redshift Spectrum/Athena
* **重要キーワード:** Kinesis Data Streams, Kinesis Data Firehose, ストリーミングデータ, データレイク, Redshift Spectrum

**(問題12より)** [cite: 6]
* **[ポイント]** データベースサーバーのOS設定（パッチ適用、ソフトウェアインストールなど）を**自社で管理したい**場合、**EC2インスタンス**上にデータベースソフトウェアをインストールして運用する必要があります。RDSやAuroraのような**マネージド型**サービスでは、OSレベルの管理はAWSが行うため、ユーザーは直接アクセスできません。
* **出題傾向:** マネージド型サービスとアンマネージド型サービス（EC2ベース）の違い、特に運用管理責任の範囲。
* **重要キーワード:** マネージド型サービス, アンマネージド型サービス, 運用管理責任

**(問題15より)** [cite: 8]
* **[ポイント]** **Aurora**はデフォルトでクラスター構成を取り、データは複数AZに6重にレプリケートされるため高い可用性を持ちます。さらに可用性を高め、フェイルオーバー時間を短縮するには、別のAZに**Auroraレプリカ**を配置します。プライマリDB障害時にはレプリカがプライマリに昇格します。Auroraは「マルチAZ配置」というRDSのような設定項目はなく、レプリカの配置でAZ分散を実現します。
* **出題傾向:** Auroraの可用性機能（クラスター構成、レプリカ）。RDSのマルチAZ配置との違い。フェイルオーバーの仕組み。
* **重要キーワード:** Aurora, Auroraレプリカ, 高可用性, フェイルオーバー, クラスター

**(問題25より)** [cite: 9]
* **[ポイント]** **DynamoDB**のワークロードが予測不能で、トラフィックが急増する可能性がある場合、**オンデマンドキャパシティモード**を選択するのが最適です。これにより、読み書きキャパシティが自動的に調整され、スロットリング（制限超過によるエラー）を防ぎつつ、コストを最適化できます。プロビジョンドモードは予測可能なワークロード向けです。
* **出題傾向:** DynamoDBのキャパシティモード（オンデマンド/プロビジョンド）の選択基準。ワークロードの特性に合わせた設定。
* **重要キーワード:** DynamoDB, オンデマンドキャパシティモード, プロビジョンドキャパシティモード, スケーラビリティ

**(問題27より)** [cite: 10]
* **[ポイント]** **RDS**インスタンスへの**読み取り要求**が増加し、パフォーマンスが低下している場合、最も一般的な解決策は**リードレプリカ**を追加することです。リードレプリカは読み取り専用のコピーであり、アプリケーションからの読み取りクエリを分散させることで、マスターDBインスタンスの負荷を軽減します。マルチAZ構成は可用性向上目的であり、読み取り性能向上には直接寄与しません。キャッシュ（ElastiCache）も有効ですが、特定のクエリが集中している場合に効果的です。
* **出題傾向:** RDSの読み取りパフォーマンス改善策。リードレプリカの役割と効果。
* **重要キーワード:** RDS, リードレプリカ, 読み取り負荷分散

**(問題30より)** [cite: 11]
* **[ポイント]** RDSの**リードレプリカ**は、マスターDBインスタンスから**非同期**でデータを複製します。そのため、ネットワーク遅延やレプリケーション処理の負荷などにより、マスターDBへの書き込みとリードレプリカへの反映に時間差（**レプリケーションラグ**）が生じることがあります。このラグにより、リードレプリカを参照した場合に古いデータが表示される可能性があります。
* **出題傾向:** リードレプリカの特性（非同期レプリケーション）と、それに伴うレプリケーションラグの発生可能性。
* **重要キーワード:** リードレプリカ, 非同期レプリケーション, レプリケーションラグ

**(問題34より)** [cite: 12]
* **[ポイント]** 数十万件の購買トランザクション結果を、ほぼリアルタイムで複数の経理アプリと共有し、かつドキュメントDB（例：DynamoDB）保存前に機密データを削除する前処理が必要な場合。**DynamoDB Streams**を利用するのが効果的です。
    1.  トランザクションデータをDynamoDBに保存。
    2.  DynamoDB Streamsを有効化し、データ変更イベントをキャプチャ。
    3.  StreamsをトリガーにLambda関数を起動。
    4.  Lambda関数内で機密データを削除する前処理を実行。
    5.  処理済みデータを別のDynamoDBテーブル（または他の保存先）に保存。
    6.  別のLambda関数（またはアプリケーション）がStreamsを読み取り、他の経理アプリとデータを共有。
    （問題の正解はDynamoDBトランザクションとStreamsを組み合わせるものでしたが、より一般的なのは上記のStreams+Lambdaパターンです。DynamoDBトランザクションは複数の操作をアトミックに行う機能です。）
* **出題傾向:** DynamoDB Streamsを用いたリアルタイムデータ連携・処理。イベント駆動型アーキテクチャ。
* **よく出るサービスの組み合わせ:** DynamoDB + DynamoDB Streams + Lambda
* **重要キーワード:** DynamoDB Streams, イベント駆動型, リアルタイム処理, データ連携

**(問題37より)** [cite: 13]
* **[ポイント]** 定期的に（例：毎週）DynamoDBからデータを取得し、別のシステム（例：レポート生成処理）に送信する必要がある場合、**AWS Data Pipeline**を利用してスケジュールされたデータ移動ジョブを作成できます。Data Pipelineは様々なAWSデータソース/ターゲット間のデータ移動や変換を自動化します。DynamoDB Streamsはイベント駆動型であり、定期実行には向きません。
* **出題傾向:** AWSサービス間の定期的なデータ移動・処理の自動化。Data Pipelineのユースケース。
* **重要キーワード:** AWS Data Pipeline, 定期実行, データ移動

**(問題43より)** [cite: 16]
* **[ポイント]** 大量の読み取り処理が発生するデータベースで、スタンバイDBへのデータ同期（エクスポート/インポート）による遅延を解消し、可用性を向上させたい場合、**Aurora Global Database**が有効です。これにより、複数リージョンに低レイテンシで読み取り可能なレプリカを配置でき、リージョン障害時のDRも実現できます。AuroraレプリカをマルチAZに展開することも読み取り分散と可用性向上に寄与します。
* **出題傾向:** Auroraの高可用性・DR機能。Aurora Global Databaseのユースケースとメリット。
* **重要キーワード:** Aurora Global Database, マルチリージョン, 低レイテンシー読み取り, ディザスタリカバリ(DR)

**(問題52 (DynamoDB)より)** [cite: 23]
* **[ポイント]** 数万人のユーザー設定（各10KB程度）を保存し、モバイルアプリのセッション処理で迅速にアクセスする必要がある場合、**DynamoDB**が適しています。低レイテンシーでの高速なキーバリューアクセスが可能で、スケーラビリティも高いため、ユーザープロファイルやセッションデータの保存によく利用されます。RDSはリレーショナル、S3はオブジェクトストレージ、RedshiftはDWHであり、このユースケースにはDynamoDBが最適です。
* **出題傾向:** データベース/ストレージサービスの選択。ワークロード特性（データモデル、アクセスパターン、レイテンシ要件、スケーラビリティ）に合わせたサービスの選択。
* **重要キーワード:** DynamoDB, NoSQL, キーバリューストア, 低レイテンシー, ユーザープロファイル, セッションデータ

**(問題52 (Redshift)より)** [cite: 23]
* **[ポイント]** **Redshift**において、複数のクエリ処理の実行順序を制御したり、リソース割り当てを管理したりするには、**WLM (Workload Management)** を使用します。クエリをキューに入れ、優先度や同時実行数、メモリ割り当てなどを設定できます。
* **出題傾向:** Redshiftのワークロード管理機能。WLMの役割。
* **重要キーワード:** Redshift, WLM (Workload Management), クエリキュー

**(問題53より)** [cite: 24]
* **[ポイント]** 大量のドキュメント（PDFなど）を保存・共有し、それらに対して**全文検索**や**フレーズ検索**を可能にしたい場合、**Amazon OpenSearch Service** (旧Elasticsearch Service) をS3と連携させる構成が考えられます。S3のデータをOpenSearchにインデックス化し、高度な検索機能を提供します。AthenaやS3 SelectはSQLベースであり、全文検索には向きません。
* **出題傾向:** ドキュメント検索システムの構築。OpenSearch Serviceのユースケース。
* **よく出るサービスの組み合わせ:** S3 + OpenSearch Service (+ Lambdaなどでのインデックス連携)
* **重要キーワード:** Amazon OpenSearch Service, 全文検索, ドキュメント検索

**(問題58より)** [cite: 26]
* **[ポイント]** RDSのマルチAZ構成においてプライマリDBに障害が発生した場合、Amazon RDSは自動的にフェイルオーバーを実行します。この際、データベースのエンドポイント（URL）として使用されている**CNAMEレコード**の向き先を、スタンバイ（セカンダリ）DBインスタンスに自動的に切り替えます。これにより、アプリケーションは接続先を変更することなく、新しいプライマリDBに接続できます。スタンバイDBは常に起動しており（ホットスタンバイ）、リブートや起動は不要です。
* **出題傾向:** RDSマルチAZフェイルオーバーの仕組み。CNAME切り替えによる透過的なフェイルオーバー。
* **重要キーワード:** RDSマルチAZ, フェイルオーバー, CNAMEレコード

**(問題6 (DB)より)** [cite: 31]
* **[ポイント]** S3に保存されたCSVデータに対してSQLクエリを実行し、結果を30日間だけ保持したい場合、**Amazon Athena**を利用するのがコスト効率が良いです。AthenaはS3上のデータに直接クエリできる**サーバーレス**なサービスであり、クエリ実行量に応じた課金です。S3のライフサイクルポリシーで30日後にデータを削除します。RDSはマネージドDBサーバー、DynamoDBはNoSQL、RedshiftはDWHであり、この用途にはAthenaが最適です。
* **出題傾向:** S3データレイクに対するクエリサービスの選択（Athena vs Redshift Spectrumなど）。サーバーレス分析。
* **よく出るサービスの組み合わせ:** S3 + Athena + S3ライフサイクルポリシー
* **重要キーワード:** Amazon Athena, サーバーレスクエリ, S3データレイク

**(問題13 (DB)より)** [cite: 33]
* **[ポイント]** Auroraデータベースに対して大量のレポート（読み取り処理）を実行するとパフォーマンスが低下する場合、**Auroraレプリカ**を増設し、レポーティング処理を**リーダーエンドポイント**に接続して実行することで、プライマリDBの負荷を軽減するのが最もコスト効率が良い方法です。Redshift連携は高コスト、ElastiCacheはキャッシュでありレポーティング接続には不向き、インスタンスタイプのスケールアップは読み取り専用対策としては非効率です。
* **出題傾向:** Aurora/RDSの読み取りパフォーマンス改善策（再掲）。Auroraレプリカとリーダーエンドポイントの活用。
* **重要キーワード:** Auroraレプリカ, リーダーエンドポイント, 読み取り負荷分散

**(問題14 (DB)より)** [cite: 33]
* **[ポイント]** リアルタイムランキングのような、スケーラビリティと可用性が高く、高速な書き込み・読み込みが必要な機能には、**DynamoDB**が適しています。さらに、リアルタイムなデータ更新とクライアントへのプッシュ通知を実現するには、**AWS AppSync**（マネージドGraphQL/PubSubサービス）とDynamoDBを連携させる構成が考えられます。AppSyncはDynamoDBと直接連携し、リアルタイムなデータ更新やサブスクリプション（変更通知）を容易に実装できます。
* **出題傾向:** リアルタイムアプリケーションのデータストア選択。DynamoDBとAppSyncの連携パターン。
* **よく出るサービスの組み合わせ:** DynamoDB + AppSync
* **重要キーワード:** DynamoDB, AWS AppSync, リアルタイムアプリケーション, GraphQL, Pub/Sub

**(問題17 (DB)より)** [cite: 36]
* **[ポイント]** DynamoDBテーブルのデータ読み取り時に古いデータ（更新前のデータ）が表示されることがあるのは、デフォルトの読み取り整合性モデルが**結果整合性**であるためです。更新が即座に全てのコピーに反映されるわけではないため、タイミングによっては古いデータが読み取られる可能性があります。常に最新のデータを読み取りたい場合は、読み取りリクエスト時に**強い整合性**を指定する必要があります（ただし、スループット低下やコスト増の可能性あり）。
* **出題傾向:** DynamoDBの整合性モデル（結果整合性 vs 強い整合性）の違いと影響。
* **重要キーワード:** DynamoDB, 結果整合性, 強い整合性

**(問題19 (DB)より)** [cite: 37]
* **[ポイント]** Lambda関数からRDSデータベースに接続する場合、多数のLambda同時実行によりデータベースへのコネクションが枯渇する可能性があります。これを効率的に管理するには**Amazon RDS Proxy**を使用します。RDS ProxyはLambda関数とRDSインスタンスの間に立ち、コネクションプーリングを提供して接続を効率的に再利用します。
* **出題傾向:** LambdaとRDSの連携における課題（コネクション管理）と解決策（RDS Proxy）。
* **よく出るサービスの組み合わせ:** Lambda + RDS Proxy + RDS
* **重要キーワード:** Amazon RDS Proxy, コネクションプーリング

**(問題21 (DB)より)** [cite: 39]
* **[ポイント]** DynamoDBテーブルの項目に対する変更（追加、更新、削除）履歴を取得したい場合、**DynamoDB Streams**を有効にします。Streamsは変更イベントを時系列で記録し、最大24時間保持します。このストリームデータをトリガーにLambda関数を実行するなどして、変更履歴を利用した処理（例：別システムへの連携、監査ログ作成）が可能です。
* **出題傾向:** DynamoDB Streamsの機能とユースケース。変更データキャプチャ(CDC)。
* **重要キーワード:** DynamoDB Streams, 変更データキャプチャ(CDC)

**(問題27 (DB)より)** [cite: 44]
* **[ポイント]** EC2インスタンスからRDS DBインスタンスへ、パスワードではなくIAM認証情報（一時的な認証トークン）を使用して安全に接続するには、RDS側で**IAM DB認証**を有効にする必要があります。EC2インスタンスには、RDSへの接続と認証トークン生成を許可するIAMロールをアタッチします。
* **出題傾向:** RDSへのセキュアな認証方法。IAM DB認証の仕組みと設定。
* **重要キーワード:** IAMデータベース認証, 認証トークン

**(問題33 (DB)より)** [cite: 47]
* **[ポイント]** Amazon RDS for MySQLでは、ストレージエンジンとして**InnoDB**が推奨されており、**MyISAM**はサポートされていません（クラッシュリカバリやトランザクション機能がないため）。オンプレミスのMySQLでMyISAMを使用している場合は、移行前にInnoDBへの変換が必要です。
* **出題傾向:** RDSの制約事項やベストプラクティス。特定のDBエンジン機能のサポート状況。
* **重要キーワード:** RDS for MySQL, InnoDB, MyISAM (非推奨)

**(問題35 (DB)より)** [cite: 48]
* **[ポイント]** 読み取りが多いWebアプリケーションで、データベース負荷を軽減し応答速度を向上させるには、**ElastiCache**（特に**Memcached**）によるキャッシュ層の導入が効果的です。頻繁にアクセスされるDBクエリ結果などをキャッシュに保持し、DBへのアクセスを減らします。**RDSリードレプリカ**も読み取り負荷分散に有効です。アプリケーション層（EC2）は**ステートレス**に設計し、**ELB**と**Auto Scaling**でスケールさせるのが一般的です。
* **出題傾向:** Webアプリケーションのパフォーマンスチューニング。キャッシュ戦略（ElastiCache）と読み取りレプリカ（RDSリードレプリカ）の組み合わせ。ステートレス設計の重要性。
* **重要キーワード:** ElastiCache (Memcached/Redis), キャッシュ, RDSリードレプリカ, ステートレス

**(問題39 (DB)より)** [cite: 51]
* **[ポイント]** ユーザーセッション情報の管理には、高速な読み書きとスケーラビリティが求められます。**DynamoDB**（NoSQLキーバリューストア）や**ElastiCache for Redis**（インメモリデータストア）が適しています。これらは低レイテンシーで大量のセッションデータを処理できます。
* **出題傾向:** セッション管理に適したデータストアの選択。DynamoDBとElastiCacheのユースケース。
* **重要キーワード:** DynamoDB, ElastiCache for Redis, セッション管理

**(問題43 (DB)より)** [cite: 53]
* **[ポイント]** RDS DBインスタンスのOSレベルのメトリクス（メモリ使用量、プロセスごとのCPU/メモリ使用状況など）を詳細に監視したい場合、**RDS拡張モニタリング**を有効にします。これにより、CloudWatch Logsに追加のメトリクスが送信され、より詳細なパフォーマンス分析が可能になります。
* **出題傾向:** RDSの監視機能。標準モニタリングと拡張モニタリングの違い。
* **重要キーワード:** RDS拡張モニタリング, CloudWatch Logs

**(問題44 (DB)より)** [cite: 54]
* **[ポイント]** Redshiftクラスターへの/からのCOPYやUNLOADトラフィックをVPC内に強制し、VPCフローログなどで監視・制御したい場合、**Redshift拡張VPCルーティング**を有効にします。これにより、セキュリティグループやネットワークACLによる制御が可能になります。
* **出題傾向:** Redshiftのネットワークセキュリティ機能。拡張VPCルーティングの目的と効果。
* **重要キーワード:** Redshift拡張VPCルーティング, VPCフローログ

**(問題46 (DB)より)** [cite: 56]
* **[ポイント]** Amazon RDS DBインスタンスに保存された製品データが**新規に登録**されたことをトリガーとして、他のシステムに非同期でデータを送信する場合、RDS自体にはDynamoDB Streamsのようなデータ変更イベントを直接トリガーする機能はありません。一般的なアプローチは、**定期的にLambda関数を実行**（例: EventBridge Schedulerを使用）し、Lambda関数がRDS（RDS Proxy経由推奨）に接続して新規または更新されたデータをポーリングし、取得したデータをSNSやSQS経由で他のシステムに送信する方法です。
* **出題傾向:** RDSをデータソースとするイベント連携・非同期処理の方法。LambdaやEventBridge、SNS/SQSとの組み合わせ。
* **重要キーワード:** 定期実行(EventBridge Scheduler), Lambda関数, RDS Proxy, 非同期連携

**(問題50 (DB) より)** [cite: 58]
* **[ポイント]** オンプレミスの読み取り集中型MySQLデータベースをAWSに移行し、最大限の可用性とスケーラビリティを確保したい場合、**Aurora MySQL**を選択し、**Auto Scaling**を使用して**Auroraレプリカ**を自動的にプロビジョニングするのが最適です。AuroraはRDS for MySQLより高性能・高可用であり、Auto Scalingレプリカにより読み取り負荷に自動で対応できます。
* **出題傾向:** DB移行時のサービス選択。AuroraとRDSの比較。読み取り負荷への対応（Auroraレプリカ + Auto Scaling）。
* **重要キーワード:** Aurora MySQL, Auroraレプリカ, Aurora Auto Scaling, 高可用性, スケーラビリティ

**(問題51 (DB) より)** [cite: 59]
* **[ポイント]** **DynamoDB**の主なユースケースとして、**WEBセッション管理**や、**メタデータ**（例：S3オブジェクトのインデックス情報）の保存が挙げられます。低レイテンシーでの高速なキーアクセスが必要で、スキーマが柔軟、かつ高いスケーラビリティが求められる場合に適しています。BLOBデータや画像データ本体の保存にはS3が、SQL処理にはRDS/Aurora/Redshiftが適しています。
* **出題傾向:** DynamoDBの適切なユースケースの理解。他のDB/ストレージサービスとの違い。
* **重要キーワード:** DynamoDBユースケース, WEBセッション管理, メタデータストア

**(問題6 (DB/アナリティクス) より)** [cite: 63]
* **[ポイント]** 大量のログデータをS3に保存し、そのデータに対して**データ分析**を行いたい場合、**Amazon EMR** (Hadoop/Sparkクラスター) が適しています。EMRは大規模なデータ処理と分析に特化しており、S3上のデータに直接アクセスして処理できます。S3 Selectは簡単なフィルタリング、Lambdaは小規模処理向けです。
* **出題傾向:** S3データレイクに対する分析プラットフォームの選択。EMRのユースケース（ビッグデータ処理）。
* **よく出るサービスの組み合わせ:** S3 + EMR
* **重要キーワード:** Amazon EMR, ビッグデータ分析, S3データレイク

**(問題10 (DB/アナリティクス) より)** [cite: 64]
* **[ポイント]** (問題6と同様) 大量のログファイルを高性能に分析するには、S3にファイルを保存し、**Amazon EMR**で処理するのが最適です。
* **重要キーワード:** Amazon EMR, ログ分析

**(問題53 (DB/アナリティクス) より)** [cite: 71]
* **[ポイント]** 大量のドキュメントデータをS3に保存し、それに対して**高度な検索機能**（全文検索、フレーズ検索、ファセット検索など）を提供したい場合は、**Amazon OpenSearch Service** (旧 Elasticsearch Service) を利用します。S3のデータをOpenSearchにインデックス化することで、リッチな検索体験を実現できます。AthenaやRedshift SpectrumはSQLベースの分析向けです。
* **出題傾向:** 検索ソリューションの構築。OpenSearch Serviceのユースケース。
* **重要キーワード:** Amazon OpenSearch Service, 全文検索, インデックス

**(問題62 (DB/アナリティクス) より)** [cite: 76]
* **[ポイント]** EC2インスタンスで実施しているデータ変換処理（ETL）をAWS Glueに移行する場合、**AWS Glueクローラー**を使用してS3などのデータソースをスキャンし、スキーマ情報を**AWS Glueデータカタログ**に自動登録します。その後、Glueジョブ（Python/Spark）でデータ変換処理を実行し、結果をRedshiftなどのターゲットにロードします。
* **出題傾向:** AWS Glueを用いたETLプロセスの構築。クローラーとデータカタログの役割。
* **よく出るサービスの組み合わせ:** S3 + Glueクローラー + Glueデータカタログ + Glueジョブ + Redshift/S3(ターゲット)
* **重要キーワード:** AWS Glue, ETL, Glueクローラー, Glueデータカタログ, スキーマ検出

**(問題1 (DB/アナリティクス) より)** [cite: 78]
* **[ポイント]** 1分ごとに送信される大量のトレーディングデータをリアルタイムで分析し、結果をS3に書き込みたい場合、**Amazon Managed Service for Apache Flink** (旧 Kinesis Data Analytics) を使用します。Flinkアプリケーションでリアルタイム分析ロジックを実装し、出力シンクとしてS3バケットを指定すれば、処理結果を直接S3に書き込めます。Kinesis Data StreamsやFirehoseを間に挟む必要はありません。
* **出題傾向:** リアルタイムストリーム分析。Managed Service for Apache Flinkのユースケース。
* **重要キーワード:** Amazon Managed Service for Apache Flink, リアルタイム分析, ストリーム処理, シンク(S3)

**(問題44 (DB/アナリティクス) より)** [cite: 86]
* **[ポイント]** 複数のデータソース（S3, RDSなど）にまたがるデータを統合的に分析し、かつユーザーごとのアクセス権限を細かく管理したい場合、**AWS Lake Formation**が有効です。Lake Formationはデータレイクの構築・管理・セキュリティ設定を一元化するサービスです。GlueクローラーやJDBC接続でデータソースをカタログ化し、Lake Formationの権限モデルでテーブル/列レベルのアクセス制御を設定できます。分析にはAthenaやRedshift Spectrumなどを利用します。
* **出題傾向:** データレイクの構築とガバナンス。Lake Formationの役割と機能（データカタログ連携、アクセス制御）。
* **重要キーワード:** AWS Lake Formation, データレイク, データカタログ, アクセス制御

#### 3.4 学習Tips

* **RDB vs NoSQL:** リレーショナルデータベース（RDS, Aurora）とNoSQLデータベース（DynamoDB）の特性（データモデル、整合性、スケーラビリティ、クエリ言語など）の違いと、それぞれの代表的なユースケースをしっかり理解しましょう。
* **マネージド vs アンマネージド:** RDS/Aurora/DynamoDBなどのマネージドサービスと、EC2にDBをインストールするアンマネージド構成のメリット・デメリット（運用負荷、柔軟性、コストなど）を比較できるようにしておきましょう。
* **可用性と読み取り性能:** RDS/AuroraにおけるマルチAZ構成（可用性向上）とリードレプリカ（読み取り性能向上）の目的と仕組みの違いを明確に区別しましょう。
* **キャッシュの役割:** ElastiCache（Redis/Memcached）が、どの層（DB層の前）に配置され、どのような効果（DB負荷軽減、応答速度向上）をもたらすのかを理解しましょう。
* **データウェアハウス:** Redshiftがなぜ高速な分析クエリを実現できるのか（カラムナストレージ、超並列処理）の基本原理と、Redshift SpectrumによるS3データレイク連携を把握しましょう。

#### 3.5 理解度チェックテスト

**(選択式)**

1.  予測不能なトラフィックがあり、サーバー管理の手間を最小限にしたいNoSQLデータベースの要件に最も適したDynamoDBのキャパシティモードはどれですか？
    a) プロビジョンドモード + Auto Scaling
    b) プロビジョンドモード + リザーブドキャパシティ
    c) オンデマンドモード
    d) DAXモード

2.  RDS for MySQLデータベースの読み取り負荷が高く、パフォーマンスが低下しています。最もコスト効率よく読み取り性能を向上させる方法はどれですか？
    a) インスタンスタイプをスケールアップする
    b) マルチAZ配置を有効にする
    c) リードレプリカを追加する
    d) ElastiCache for Redisを追加する

**(短記述式)**

3.  Amazon Auroraと標準的なAmazon RDS for MySQL/PostgreSQLの主な違い（メリット）を2つ挙げてください。

**(解答例)**

1.  c) オンデマンドモード
2.  c) リードレプリカを追加する
3.  Amazon Auroraの主な違い（メリット）例:
    * **パフォーマンス:** 標準的なMySQL/PostgreSQLよりも大幅に高速なスループット。
    * **スケーラビリティ:** ストレージが最大128TBまで自動的にスケールする。最大15個の低レイテンシなリードレプリカを作成可能。
    * **可用性と耐久性:** データが3つのAZに6重にレプリケートされ、自己修復機能を持つ。フェイルオーバーが高速。
    * **マネージド機能:** バックアップ、パッチ適用、モニタリングなどが自動化されている（RDS共通）。
    * **追加機能:** Aurora Serverless, Aurora Global Databaseなどの高度な機能。

#### 3.6 頻出キーワード

* Amazon RDS (Relational Database Service)
* Amazon Aurora
* Amazon DynamoDB
* Amazon Redshift
* Amazon ElastiCache (Redis, Memcached)
* リレーショナルデータベース (RDB)
* NoSQLデータベース (キーバリュー, ドキュメント)
* データウェアハウス (DWH)
* インメモリキャッシュ
* マネージド型サービス / アンマネージド型
* マルチAZ配置 / フェイルオーバー
* リードレプリカ / Auroraレプリカ
* キャパシティモード (プロビジョンド/オンデマンド)
* RCU / WCU (読み取り/書き込みキャパシティユニット)
* DynamoDB Accelerator (DAX)
* DynamoDB Streams
* TTL (Time To Live)
* Redshift Spectrum
* WLM (Workload Management)
* カラムナストレージ (列指向)
* 強い整合性 / 結果整合性
* IAMデータベース認証
* RDS拡張モニタリング
* RDS Proxy
* AWS Data Pipeline
* Amazon Managed Service for Apache Flink
* AWS Lake Formation
* AWS Glue (クローラー, データカタログ)
* Amazon Athena
* Amazon OpenSearch Service

---

### 第4章: ネットワークとコンテンツ配信 (VPC, Route 53, CloudFront, ELB, Direct Connect, VPN, Global Accelerator)

#### 4.1 分野概要

AWSのネットワークサービスは、クラウド内に安全で隔離されたネットワーク環境を構築したり、インターネット経由でのアクセスを制御・最適化したりするための基盤を提供します。仮想プライベートクラウド**VPC**、DNSサービスの**Route 53**、コンテンツ配信ネットワーク**CloudFront**、負荷分散の**ELB**、オンプレミスとの専用線接続**Direct Connect**、VPN接続、そしてグローバルなアプリケーション配信を高速化する**Global Accelerator**などが含まれます。これらのサービスを組み合わせて、セキュアで高性能、かつ可用性の高いネットワークアーキテクチャを設計することが求められます。

#### 4.2 主要AWSサービス解説

* **Amazon VPC (Virtual Private Cloud):**
    * AWSクラウド内に論理的に隔離されたプライベートな仮想ネットワーク空間を作成できるサービス。
    * **サブネット:** VPC内のIPアドレス範囲を分割したもの。AZ内に作成。
        * **パブリックサブネット:** **インターネットゲートウェイ(IGW)** へのルートを持つ。インターネットとの送受信が可能。
        * **プライベートサブネット:** IGWへのルートを持たない。デフォルトではインターネットと通信不可。
    * **ルートテーブル:** サブネットからのトラフィックの経路を定義。
    * **インターネットゲートウェイ(IGW):** VPCとインターネット間の通信を可能にする。
    * **NATゲートウェイ/NATインスタンス:** プライベートサブネット内のインスタンスがインターネットへ接続（例: OSアップデート）できるようにする（戻りの通信のみ許可）。NATゲートウェイはマネージド型で高可用。
    * **ネットワークACL(NACL):** サブネットレベルの**ステートレス**なファイアウォール。許可/拒否ルールを番号順に評価。
    * **セキュリティグループ:** インスタンスレベルの**ステートフル**なファイアウォール。許可ルールのみ設定。
    * **VPCピアリング:** 2つのVPC間をプライベートに接続。リージョン間も可能。推移的ルーティングは不可。
    * **VPCエンドポイント:** VPCからインターネットを経由せずにAWSサービス（S3, DynamoDBなど）や他のVPCエンドポイントサービスへプライベートに接続。
        * **ゲートウェイエンドポイント:** S3, DynamoDB用。ルートテーブルに設定。
        * **インターフェイスエンドポイント (PrivateLink):** ENIを使用。多くのAWSサービスに対応。
    * **重要キーワード:** VPC, サブネット(パブリック/プライベート), ルートテーブル, インターネットゲートウェイ(IGW), NATゲートウェイ, ネットワークACL(NACL), セキュリティグループ, VPCピアリング, VPCエンドポイント(ゲートウェイ/インターフェイス)

* **Amazon Route 53:**
    * スケーラブルで可用性の高い**DNS (Domain Name System)** ウェブサービス。ドメイン名の登録・管理、DNS名前解決、**ヘルスチェック**機能を提供。
    * **ルーティングポリシー:** DNSクエリに対してどのように応答するかを決定。
        * **シンプル:** 単一リソースへルーティング。
        * **フェイルオーバー:** アクティブ/パッシブ構成。ヘルスチェックに基づき障害時にセカンダリへ切り替え。
        * **加重:** 指定した重み付け比率で複数のリソースへトラフィックを分散。A/Bテストなどに利用。
        * **レイテンシー:** ユーザーに最も近い（低レイテンシーな）リージョンのリソースへルーティング。
        * **位置情報:** ユーザーの地理的な場所（国、大陸など）に基づいてルーティング。地域制限などに利用。
        * **地理的近接性:** リソースの地理的な場所とユーザーの場所に基づき、バイアスをかけてルーティング範囲を調整。
        * **複数値回答:** 最大8つの正常なレコードをランダムに返す。クライアント側での負荷分散・フェイルオーバー。
    * **エイリアス(Alias)レコード:** Route 53独自のレコードタイプ。ELB, CloudFront, S3ウェブサイトなどのAWSリソースのDNS名を直接指定可能。CNAMEと異なりZone Apex (ネイキッドドメイン) にも設定可能。
    * **ヘルスチェック:** エンドポイント（IPアドレス、ドメイン名、CloudWatchアラームなど）の状態を監視し、異常時にルーティングから除外。
    * **重要キーワード:** DNS, ドメイン名, ホストゾーン(パブリック/プライベート), レコードタイプ(A, AAAA, CNAME, MX, Alias), ルーティングポリシー, ヘルスチェック

* **Amazon CloudFront:**
    * グローバルな**コンテンツ配信ネットワーク(CDN)**サービス。
    * 世界中に分散した**エッジロケーション**にコンテンツ（静的/動的）をキャッシュし、ユーザーに最も近い場所から配信することで、レイテンシーを削減し高速化。
    * **オリジン:** コンテンツの元となるサーバー（S3バケット, EC2インスタンス, ELB, オンプレミスサーバーなど）。
    * **ディストリビューション:** CloudFrontの設定単位。
    * **キャッシュ動作:** キャッシュの有効期間(TTL)、キャッシュキー（URLパス、ヘッダー、Cookie、クエリ文字列）、転送するヘッダーなどを設定。
    * **セキュリティ:** HTTPS通信（ACM証明書連携）、**署名付きURL/Cookie**によるプライベートコンテンツ配信、**OAI/OAC**によるS3オリジンへの直接アクセス制限、WAF連携による攻撃防御。
    * **Lambda@Edge:** エッジロケーションでLambda関数を実行し、リクエスト/レスポンスをカスタマイズ。
    * **重要キーワード:** CDN, エッジロケーション, キャッシュ, オリジン, ディストリビューション, TTL, キャッシュキー, HTTPS, 署名付きURL/Cookie, OAI/OAC, WAF連携, Lambda@Edge

* **Elastic Load Balancing (ELB):**
    * 受信アプリケーショントラフィックを複数のターゲット（EC2インスタンス、コンテナ、IPアドレスなど）に自動的に分散するサービス。
    * **Application Load Balancer (ALB):** レイヤー7（HTTP/HTTPS）で動作。パスベース、ホストベースルーティングなど高度なルーティングが可能。マイクロサービスやコンテナ環境に最適。
    * **Network Load Balancer (NLB):** レイヤー4（TCP/UDP/TLS）で動作。超低レイテンシー、高スループット。静的IPアドレスを提供可能。
    * **Gateway Load Balancer (GWLB):** 仮想アプライアンス（ファイアウォールなど）のデプロイ、スケーリング、管理を容易にする。レイヤー3で動作。
    * **(旧) Classic Load Balancer (CLB):** 旧世代。新規利用は非推奨。
    * **リスナー:** 接続リクエストをチェックするプロセス。プロトコルとポートを定義。
    * **ターゲットグループ:** ルーティング先のターゲット（EC2など）のグループ。ヘルスチェックを設定。
    * **ヘルスチェック:** ターゲットの状態を定期的に確認し、異常なターゲットをトラフィックから除外。
    * **クロスゾーン負荷分散:** 有効にすると、全てのAZのターゲットに均等にトラフィックを分散。
    * **スティッキーセッション:** 特定のユーザーからのリクエストを常に同じターゲットに送信。
    * **重要キーワード:** 負荷分散, ALB, NLB, GWLB, CLB, リスナー, ターゲットグループ, ヘルスチェック, クロスゾーン負荷分散, スティッキーセッション

* **AWS Direct Connect:**
    * オンプレミスのデータセンターやオフィスからAWSへの**専用線接続**を提供するサービス。
    * インターネットVPNよりも安定した高帯域幅、低レイテンシーな接続を実現。
    * **Direct Connectロケーション**でAWSルーターと顧客ルーターを物理的に接続。
    * **仮想インターフェイス(VIF):**
        * **プライベートVIF:** VPCへプライベートIPアドレスで接続。
        * **パブリックVIF:** S3などパブリックなAWSサービスへ接続。
        * **トランジットVIF:** Transit Gatewayへ接続。
    * **重要キーワード:** 専用線接続, 低レイテンシー, 高帯域幅, Direct Connectロケーション, VIF(プライベート/パブリック/トランジット)

* **AWS Site-to-Site VPN:**
    * オンプレミスネットワークとVPC間を**IPsec VPNトンネル**で安全に接続。インターネット経由。
    * **カスタマーゲートウェイ(CGW):** オンプレミス側のVPNデバイス。
    * **仮想プライベートゲートウェイ(VGW)/トランジットゲートウェイ(TGW):** AWS側のVPN終端。
    * **Accelerated Site-to-Site VPN:** Global Acceleratorを利用し、VPNパフォーマンスを向上。
    * **重要キーワード:** VPN, IPsec, カスタマーゲートウェイ(CGW), 仮想プライベートゲートウェイ(VGW), トランジットゲートウェイ(TGW), Accelerated VPN

* **AWS Global Accelerator:**
    * AWSのグローバルネットワークインフラストラクチャを利用して、アプリケーションへの**アクセス経路を最適化**し、パフォーマンスと可用性を向上させるサービス。
    * ユーザーに最も近い**エッジロケーション**でトラフィックを受け付け、AWSグローバルネットワーク上の最適経路でアプリケーションエンドポイント（ALB, NLB, EC2, EIP）へ転送。
    * 静的な**エニーキャストIPアドレス**を提供。
    * DDoS攻撃からの保護にも寄与。
    * **重要キーワード:** グローバルネットワーク, パフォーマンス向上, 可用性向上, エッジロケーション, エニーキャストIP

#### 4.3 問題演習とポイント解説

**(問題7より)** [cite: 4]
* **[ポイント]** インターネットに接続させたくない重要なサーバー（例：データベースサーバー）は**プライベートサブネット**に配置するのが基本です。プライベートサブネット内のインスタンスがOSアップデートなどでインターネットに接続する必要がある場合は、パブリックサブネットに**NATゲートウェイ**を設置し、プライベートサブネットのルートテーブルからNATゲートウェイへのルートを設定します。これにより、インスタンスからのアウトバウンド通信のみが可能になります。
* **出題傾向:** VPCの基本的なセキュリティ設計。パブリック/プライベートサブネットの使い分けとNATゲートウェイの役割。
* **重要キーワード:** プライベートサブネット, パブリックサブネット, NATゲートウェイ

**(問題9より)** [cite: 5]
* **[ポイント]** ユーザーの地理的な場所に基づいてコンテンツの言語を切り替えたり、特定の地域のユーザーを特定のサーバーに誘導したりしたい場合、**Route 53の位置情報ルーティングポリシー**を使用します。ユーザーのDNSクエリの発信元地域に基づいてルーティング先を決定します。地理的近接性ルーティングはリソースとユーザーの物理的な距離に基づきます。
* **出題傾向:** Route 53の各ルーティングポリシーの特徴とユースケースの選択。特に位置情報、レイテンシー、地理的近接性の違い。
* **重要キーワード:** Route 53, 位置情報ルーティングポリシー, 地理的近接性ルーティングポリシー

**(問題42より)** [cite: 18]
* **[ポイント]** S3バケットに保存されたコンテンツをCloudFrontで配信する際、外部からの**直接リンク（URL参照）を禁止**したい場合、**AWS WAF** (Web Application Firewall) をCloudFrontに設定し、**Refererヘッダー**に基づいてアクセスを制限するルールを作成します。これにより、許可された特定のWebサイトからのリクエストのみを受け付けるようにできます。署名付きURL/Cookieは一時的なアクセス許可であり、恒久的なリンク禁止には向きません。
* **出題傾向:** CloudFrontとWAFの連携によるアクセス制御。Referer制限のユースケース。
* **よく出るサービスの組み合わせ:** CloudFront + WAF
* **重要キーワード:** AWS WAF, Referer制限, アクセス制御

**(問題47より)** [cite: 20]
* **[ポイント]** プライマリ/セカンダリ構成で、プライマリ障害時に自動的にセカンダリへ切り替える**アクティブ/パッシブフェイルオーバー**を実現するには、**Route 53のフェイルオーバールーティングポリシー**を使用します。ヘルスチェックを設定し、プライマリが異常になった場合にセカンダリへトラフィックを向けます。
* **出題傾向:** Route 53を用いたDR/フェイルオーバー構成。アクティブ/パッシブとアクティブ/アクティブの違い。フェイルオーバールーティングポリシーの役割。
* **重要キーワード:** Route 53, フェイルオーバールーティングポリシー, アクティブ/パッシブフェイルオーバー, ヘルスチェック

**(問題53 (Route53)より)** [cite: 22]
* **[ポイント]** Route 53でCloudFrontディストリビューションやELBなどのAWSリソースに独自のドメイン名を関連付ける場合、**エイリアス(Alias)レコード**を使用します。レコードタイプは、IPv4の場合は**Aレコード**、IPv6の場合は**AAAAレコード**を選択します。CNAMEレコードではZone Apex（ネイキッドドメイン、例：example.com）に設定できませんが、エイリアスレコードなら可能です。
* **出題傾向:** Route 53のレコードタイプ、特にエイリアスレコードの特徴と使い方。CNAMEとの違い。AWSリソースとの連携。
* **重要キーワード:** Route 53, エイリアスレコード, Aレコード, AAAAレコード, CloudFront, ELB

**(問題63より)** [cite: 27]
* **[ポイント]** VPCのサブネット間のトラフィックや、サブネットとインターネット間のトラフィックを制御するには**ネットワークACL (NACL)** を使用します。NACLは**ステートレス**であり、インバウンドルールとアウトバウンドルールの両方を明示的に設定する必要があります。例えば、外部からのSSH接続（インバウンド）を許可する場合、戻りのトラフィック（アウトバウンド）も許可する必要があります。戻りトラフィックのポートは**エフェメラルポート**（通常1024-65535）の範囲で許可します。
* **出題傾向:** ネットワークACLの特性（ステートレス）、ルール評価順序（番号昇順）、設定方法（インバウンド/アウトバウンド両方必要）。セキュリティグループ（ステートフル）との違い。
* **重要キーワード:** ネットワークACL(NACL), ステートレス, インバウンド/アウトバウンドルール, エフェメラルポート

**(問題65 (VPC エンドポイント)より)** [cite: 29]
* **[ポイント]** VPC内のEC2インスタンスからS3バケットへのアクセスを、インターネットを経由せずAWSネットワーク内で完結させ、かつデータ転送料金を節約するには、**ゲートウェイVPCエンドポイント**または**インターフェイスVPCエンドポイント (PrivateLink)** を利用します。
    * **ゲートウェイエンドポイント:** ルートテーブルに設定。無料。S3/DynamoDBのみ対応。
    * **インターフェイスエンドポイント:** サブネットにENIを作成。有料。多くのAWSサービスに対応。セキュリティグループ適用可。
    どちらを選択するかは、対応サービス、コスト、セキュリティ要件によります。
* **出題傾向:** VPCエンドポイントの種類（ゲートウェイ/インターフェイス）と特徴、使い分け。プライベート接続の実現方法。
* **重要キーワード:** VPCエンドポイント, ゲートウェイエンドポイント, インターフェイスエンドポイント(PrivateLink), プライベート接続

**(問題1 (VPC/接続)より)** [cite: 28]
* **[ポイント]** オンプレミスとAWS間の接続で、プライマリは低レイテンシ・高可用性（**Direct Connect**）、セカンダリ（バックアップ）はコスト重視で性能低下許容（**サイト間VPN**）という構成が考えられます。Direct Connectは専用線で高性能・高コスト、VPNはインターネット経由で低コスト・性能変動あり。要件に合わせて組み合わせます。
* **出題傾向:** オンプレミス接続方法（Direct Connect vs VPN）の選択。可用性、パフォーマンス、コストのトレードオフ。冗長構成のパターン。
* **重要キーワード:** Direct Connect, サイト間VPN, ハイブリッドクラウド, 冗長化

**(問題27 (VPC/接続)より)** [cite: 44]
* **[ポイント]** VPCを作成する際、サブネットに割り当てるCIDRブロックのサイズ（サブネットマスク）によって利用可能なIPアドレス数が決まります。マスク値が小さいほど（例：/16）、範囲は広くアドレス数は多くなり、マスク値が大きいほど（例：/28）、範囲は狭くアドレス数は少なくなります。`/24` は256個（AWS予約分を除く）、`/27` は32個（予約除く27個）、`/28` は16個（予約除く11個）のアドレスが利用可能です。200個のアドレスが必要な場合、`/24`が最適です（`/25`=128個, `/23`=512個）。
* **出題傾向:** CIDR表記とサブネットマスク、利用可能IPアドレス数の関係の理解。適切なCIDRブロックサイズの選択。
* **重要キーワード:** CIDR, サブネットマスク, IPアドレス数

**(問題28 (VPC/接続)より)** [cite: 44]
* **[ポイント]** プライベートサブネット内のEC2インスタンスに外部（例：クライアントPC）からアクセスするには、**踏み台サーバー**（Bastion Host）をパブリックサブネットに設置し、そこを経由してSSH接続するのが一般的です。また、プライベートサブネット内のインスタンスがインターネットへアクセス（例：ソフトウェア更新）するには、パブリックサブネットに**NATゲートウェイ**が必要です。
* **出題傾向:** プライベートサブネットへのアクセス方法（踏み台）、プライベートサブネットからのインターネットアクセス方法（NATゲートウェイ）。
* **よく出るサービスの組み合わせ:** VPC (Public/Private Subnet) + EC2 (Bastion/App Server) + NAT Gateway + Security Group/NACL
* **重要キーワード:** 踏み台サーバー(Bastion Host), NATゲートウェイ

**(問題32 (Route53)より)** [cite: 46]
* **[ポイント]** Route 53でALBなどのAWSリソースに独自ドメイン（例：`pintor.com`）を割り当てる場合、**エイリアス(Alias)レコード**を使用します。ターゲットとしてALBのDNS名を指定します。IPv4アドレスを返す場合は**Aレコード**タイプ、IPv6アドレスを返す場合は**AAAAレコード**タイプを選択します。デュアルスタック（IPv4/IPv6両対応）の場合は、AとAAAAの両方のエイリアスレコードを作成します。
* **出題傾向:** 問題53と同様。エイリアスレコードとA/AAAAレコードタイプの組み合わせ。
* **重要キーワード:** エイリアスレコード, Aレコード, AAAAレコード, デュアルスタック

**(問題34 (VPC/接続)より)** [cite: 48]
* **[ポイント]** VPC内で起動したEC2インスタンスが自動的に**DNSホスト名**（例：`ip-10-0-1-17.ap-northeast-1.compute.internal`）を受け取るためには、VPCの設定で**`enableDnsHostnames`** 属性を`true`にする必要があります。また、VPC内のDNS解決（Route 53 Resolver）を利用するには**`enableDnsSupport`** 属性も`true`にする必要があります（デフォルトで有効）。
* **出題傾向:** VPCのDNS設定オプション（`enableDnsSupport`, `enableDnsHostnames`）の役割。
* **重要キーワード:** VPC DNS設定, enableDnsHostnames, enableDnsSupport

**(問題38 (VPC/接続)より)** [cite: 49]
* **[ポイント]** オンプレミスとAWS間の**サイト間VPN**接続を確立するには、オンプレミス側に**カスタマーゲートウェイ(CGW)** デバイス（物理またはソフトウェア）を設置し、AWS VPC側に**仮想プライベートゲートウェイ(VGW)** または**トランジットゲートウェイ(TGW)** を作成します。CGWとVGW/TGW間でIPsecトンネルを確立します。CGWには静的ルートまたはBGPルートを設定します。
* **出題傾向:** サイト間VPNの構成要素（CGW, VGW/TGW）と設定の基本。
* **重要キーワード:** サイト間VPN, カスタマーゲートウェイ(CGW), 仮想プライベートゲートウェイ(VGW)

**(問題4 (VPC/接続)より)** [cite: 60]
* **[ポイント]** 複数のVPC間でピアリング接続が確立されている場合でも、**推移的なルーティングはサポートされません**。例えば、VPC-A と VPC-B がピアリングされ、VPC-A が Direct Connect でオンプレミスと接続されている場合、VPC-B から直接 Direct Connect 経由でオンプレミスにアクセスすることはできません。VPC-B もオンプレミスと接続したい場合は、VPC-B 用に別途 Direct Connect や VPN 接続を設定するか、Transit Gateway を利用する必要があります。
* **出題傾向:** VPCピアリングの制約事項、特に推移的ルーティングの不可能性。
* **重要キーワード:** VPCピアリング, 推移的ルーティング

**(問題8 (VPC/ネットワーク/配信)より)** [cite: 62]
* **[ポイント]** 異なるリージョンのVPC間をプライベートに接続するには、**VPCピアリング**（Inter-Region VPC Peering）を利用します。接続後は、ルートテーブルの設定に加えて、**セキュリティグループ**や**ネットワークACL**で相互の通信を許可する必要があります。リージョンをまたぐ場合、セキュリティグループのルールではIPアドレス範囲を指定する必要があります（同一リージョン内ならSG-ID指定可）。
* **出題傾向:** リージョン間VPCピアリングの設定と通信許可。セキュリティグループのリージョン間での扱い。
* **重要キーワード:** リージョン間VPCピアリング, セキュリティグループ（IP指定）

**(問題9 (VPC/ネットワーク/配信)より)** [cite: 62]
* **[ポイント]** 多数のVPC（数十以上）やオンプレミス接続（VPN, Direct Connect）を**シンプルかつスケーラブルに相互接続**したい場合、**AWS Transit Gateway (TGW)** をハブとして利用する構成が最適です。各VPCやVPN/DX接続をTGWにアタッチすることで、TGWがルーティングを中継し、フルメッシュ接続や複雑なピアリング設定が不要になります。
* **出題傾向:** 大規模ネットワークの接続ハブとしてのTransit Gatewayの役割とメリット。VPCピアリングとの比較。
* **重要キーワード:** AWS Transit Gateway (TGW), ハブアンドスポーク, ネットワーク簡素化

**(問題16 (VPC/移行)より)** [cite: 65]
* **[ポイント]** IPフローティングは、主にEC2インスタンスの障害時に**Elastic IPアドレス**または**ENI**を正常な待機系インスタンスに付け替えることで、ダウンタイムを最小限に抑える高可用性パターンです。DNS切り替えよりも迅速なフェイルオーバーが可能です。
* **出題傾向:** 高可用性パターンの理解。IPフローティングの仕組みとメリット。
* **重要キーワード:** IPフローティング, Elastic IP (EIP), ENI (Elastic Network Interface), フェイルオーバー

**(問題21 (VPC/接続)より)** [cite: 67]
* **[ポイント]** アベイラビリティゾーン(AZ)は、1つ以上の物理的なデータセンターから構成される、リージョン内の独立した区画です。電源、冷却、ネットワークなどが冗長化され、他のAZとは低レイテンシーなネットワークで接続されます。エッジロケーションは、CloudFrontやRoute 53、Global AcceleratorなどがコンテンツキャッシュやDNS解決、トラフィック受付を行うために世界中に分散配置された拠点であり、AZとは異なる概念です。
* **出題傾向:** AWSグローバルインフラストラクチャの基本要素（リージョン、AZ、エッジロケーション）の定義と役割の理解。
* **重要キーワード:** リージョン, アベイラビリティゾーン(AZ), エッジロケーション

**(問題49 (VPC/ネットワーク/配信)より)** [cite: 70]
* **[ポイント]** CloudFrontでURLの**クエリ文字列パラメータ**（例：`?language=jp`）に基づいてコンテンツをキャッシュし、異なるパラメータ値ごとに別のキャッシュを持つようにするには、CloudFrontの**キャッシュ動作設定**で「クエリ文字列の転送とキャッシュ」を適切に設定します（例：「すべて転送、個別キャッシュ」や「ホワイトリスト」で特定のパラメータを指定）。これにより、同じURLパスでもパラメータが異なれば異なるコンテンツを配信・キャッシュできます。
* **出題傾向:** CloudFrontのキャッシュキー設定。クエリ文字列、ヘッダー、Cookieによるキャッシュの制御。
* **重要キーワード:** CloudFront, キャッシュキー, クエリ文字列パラメータ

**(問題53 (VPC/接続)より)** [cite: 71]
* **[ポイント]** マルチキャスト通信（1対多のデータ送信）が必要なレガシーアプリケーションをAWSで実行する場合、VPCはデフォルトではマルチキャストをサポートしていません。これを実現するには、**AWS Transit Gateway**の**マルチキャスト機能**を有効にし、マルチキャストドメインと関連付けることで、VPC間やオンプレミスとの間でマルチキャストルーティングを可能にします。
* **出題傾向:** VPCでのマルチキャスト対応。Transit Gatewayのマルチキャスト機能。
* **重要キーワード:** マルチキャスト, AWS Transit Gateway (TGW) マルチキャスト

**(問題56 (ELB)より)** [cite: 73]
* **[ポイント]** ELB（特にALB, NLB）において、トラフィックを複数のAZに配置されたターゲットインスタンスに**均等に分散**させたい場合、**クロスゾーン負荷分散**を有効にします。無効の場合、ELBノードは自身が存在するAZ内のターゲットにのみトラフィックを分散しようとするため、AZ間でインスタンス数やトラフィック量に偏りがあると不均等になる可能性があります。ALBではデフォルトで有効、NLBではデフォルトで無効です。
* **出題傾向:** ELBのクロスゾーン負荷分散の目的と効果。有効/無効時の挙動の違い。
* **重要キーワード:** クロスゾーン負荷分散, 均等分散

**(問題59 (VPC/接続)より)** [cite: 75]
* **[ポイント]** 実行中の（ホット）または停止中の（ウォーム）インスタンスにENIをアタッチ/デタッチすることが可能です。特に停止中のインスタンス間でENIを付け替える**ウォームアタッチ**は、フェイルオーバー構成でコストを抑えつつ、比較的迅速な切り替え（インスタンス起動時間 + アタッチ時間）を実現するのに役立ちます。
* **出題傾向:** ENIのアタッチ方法（ホット、ウォーム、コールド）の理解と使い分け（再掲）。
* **重要キーワード:** ENI, ウォームアタッチ

**(問題62 (VPC/接続)より)** [cite: 76]
* **[ポイント]** ネットワークACLのルールは、**ルール番号の昇順**（小さい番号が優先）で評価されます。最初に一致したルール（AllowまたはDeny）が適用され、それ以降のルールは評価されません。一致するルールがない場合は、暗黙のDenyルールによりトラフィックは拒否されます。変更は即時に反映されます。
* **出題傾向:** ネットワークACLのルール評価順序。
* **重要キーワード:** ネットワークACL(NACL), ルール番号, 評価順序

**(問題63 (VPC/接続)より)** [cite: 77]
* **[ポイント]** プライベートサブネット内のDBサーバーを外部（SSH経由など）から更新する場合、直接アクセスはできないため、通常はパブリックサブネットに**踏み台サーバー**を設置し、そこを経由します。DBサーバー自体がインターネットに接続（例：パッチダウンロード）する必要がある場合は、パブリックサブネットに**NATゲートウェイ**を設置し、DBサーバーのサブネットのルートテーブルからNATゲートウェイへのルートを設定します。
* **出題傾向:** プライベートサブネット内のリソースへのアクセス/からのアクセスのための定型パターン（踏み台、NATゲートウェイ）。
* **重要キーワード:** 踏み台サーバー, NATゲートウェイ

**(問題10 (ネットワーク接続)より)** [cite: 91]
* **[ポイント]** 複数の支社オフィスからAWSネットワークへ、既存のインターネット回線を利用し、コスト効率よく、かつパフォーマンス（低遅延・高可用性）も向上させたい場合、**Accelerated サイト間VPN**が有効です。これは、AWS Global Acceleratorのネットワークを経由してVPN接続を行うため、通常のインターネットVPNよりも安定性とパフォーマンスが向上します。
* **出題傾向:** サイト間VPNのオプション。Accelerated VPNのメリットとユースケース。
* **重要キーワード:** Accelerated サイト間VPN, AWS Global Accelerator

**(問題30 (ネットワーク配信)より)** [cite: 96]
* **[ポイント]** グローバルなユーザーに対して、**アプリケーションアクセス**（動的コンテンツ、API）の**レイテンシーを低減**し、可用性を向上させたい場合は**AWS Global Accelerator**が適しています。**コンテンツ配信**（静的/動的）のレイテンシーを低減したい場合は**Amazon CloudFront**が適しています。両方を組み合わせて利用することも可能です（例：Global AcceleratorでALBへのアクセスを高速化し、そのALBをオリジンとしてCloudFrontでコンテンツ配信）。多言語対応にはCloudFrontのヘッダー（Accept-Language）転送などが利用できます。
* **出題傾向:** Global AcceleratorとCloudFrontの役割の違いと使い分け。組み合わせによる効果。
* **重要キーワード:** AWS Global Accelerator, Amazon CloudFront, レイテンシー削減, アプリケーションアクセス, コンテンツ配信

**(問題20 (ネットワーク接続)より)** [cite: 101]
* **[ポイント]** NLBでTCP/UDPトラフィックを負荷分散しており、アプリケーションアクセス時の**レイテンシーをグローバルに改善**したい場合、**AWS Global Accelerator**をNLBの前段に追加し、**標準アクセラレーター**のエンドポイントとしてNLBを設定します。Global Acceleratorがユーザーに最も近いエッジでトラフィックを受け付け、AWSの最適化されたネットワーク経由でNLBに転送します。カスタムルーティングアクセラレータは特定のユースケース向けです。
* **出題傾向:** Global Acceleratorのアクセラレータタイプ（標準/カスタム）の選択。NLBとの連携。
* **重要キーワード:** AWS Global Accelerator, 標準アクセラレーター, NLB連携

#### 4.4 学習Tips

* **VPC構成図:** VPC、サブネット（パブリック/プライベート）、ルートテーブル、IGW、NATゲートウェイ、セキュリティグループ、NACLの関係性を図で理解することが非常に重要です。自分で簡単な構成図を描いてみましょう。
* **Route 53ポリシーの使い分け:** 各ルーティングポリシーがどのようなシナリオで最適なのかを、具体的な例と共に整理しましょう。特に、レイテンシー、位置情報、地理的近接性の違いに注意。
* **CloudFront vs Global Accelerator:** どちらもエッジロケーションを活用しますが、CloudFrontは主にコンテンツキャッシュによる配信高速化、Global Acceleratorはネットワーク経路最適化によるアプリケーションアクセス高速化という違いがあります。目的を意識して使い分けましょう。
* **Direct Connect vs VPN:** オンプレミス接続の選択肢として、コスト、帯域、安定性、設定の複雑さなどの観点から比較できるようにしておきましょう。

#### 4.5 理解度チェックテスト

**(選択式)**

1.  プライベートサブネット内のEC2インスタンスが、OSのアップデートのためにインターネット上のリポジトリにアクセスする必要があります。インターネットからの直接アクセスは防ぎたい場合、どのコンポーネントをパブリックサブネットに配置するのが最も一般的ですか？
    a) インターネットゲートウェイ (IGW)
    b) NATゲートウェイ
    c) 仮想プライベートゲートウェイ (VGW)
    d) VPCピアリング接続

2.  ユーザーからの地理的な位置に基づいて、最も近いリージョンのサーバーにトラフィックを振り分けたい場合、Route 53のどのルーティングポリシーを使用しますか？
    a) シンプルルーティング
    b) フェイルオーバールーティング
    c) 位置情報ルーティング
    d) レイテンシールーティング

**(短記述式)**

3.  Amazon CloudFrontでS3バケットをオリジンとして使用する際に、S3バケットへの直接アクセスを禁止し、CloudFront経由でのみアクセスできるようにするための仕組み（またはその構成要素）を2つ挙げてください。

**(解答例)**

1.  b) NATゲートウェイ
2.  d) レイテンシールーティング （※位置情報ルーティングは国や州単位など大まかな地域、レイテンシーは実際の応答時間で判断するため、より「近い」サーバーへのルーティングにはレイテンシーが使われることが多い）
3.  Origin Access Identity (OAI) または Origin Access Control (OAC) をCloudFrontディストリビューションに設定し、S3バケットポリシーでそのOAI/OACからのGetObjectのみを許可する。

#### 4.6 頻出キーワード

* VPC (Virtual Private Cloud)
* サブネット (パブリック/プライベート)
* ルートテーブル
* インターネットゲートウェイ (IGW)
* NATゲートウェイ
* ネットワークACL (NACL) (ステートレス)
* セキュリティグループ (ステートフル)
* VPCピアリング (推移的ルーティング不可)
* VPCエンドポイント (ゲートウェイ/インターフェイス)
* AWS PrivateLink
* Route 53
* DNS / ホストゾーン (パブリック/プライベート)
* レコードタイプ (A, AAAA, CNAME, Alias)
* ルーティングポリシー (シンプル, フェイルオーバー, 加重, レイテンシー, 位置情報, 地理的近接性, 複数値回答)
* ヘルスチェック
* Amazon CloudFront
* CDN / エッジロケーション / キャッシュ
* オリジン / ディストリビューション
* TTL / キャッシュキー (クエリ文字列, ヘッダー, Cookie)
* 署名付きURL / 署名付きCookie
* OAI (Origin Access Identity) / OAC (Origin Access Control)
* ELB (Elastic Load Balancing)
* ALB / NLB / GWLB / CLB
* リスナー / ターゲットグループ
* クロスゾーン負荷分散
* スティッキーセッション
* AWS Direct Connect
* 専用線接続 / VIF
* AWS Site-to-Site VPN
* IPsec / カスタマーゲートウェイ(CGW) / 仮想プライベートゲートウェイ(VGW) / TGW
* Accelerated VPN
* AWS Global Accelerator
* エニーキャストIP

---

